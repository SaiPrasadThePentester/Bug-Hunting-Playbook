A File Upload Vulnerability occurs when a web application fails to properly validate or sanitize uploaded files, allowing attackers to upload malicious files (e.g., scripts, web shells, executables),If the uploaded file is executable or accessible, it can lead to remote code execution (RCE) and full server compromise

            
                                                                                How Servers Usually Validate File Uploads

File Name Validation ‚Äì checking the uploaded file name
Extension Validation ‚Äì .jpg, .png, .pdf, etc.
Content-Type Validation ‚Äì image/jpeg, application/pdf
Content Inspection ‚Äì checking file headers (magic bytes)
File Size Validation ‚Äì restricting large uploads



                                                                                          Practical Testing


  Step 1: Identify File Upload Functionality
During security testing, first identify where the application allows users to upload files, such as:
üë§ Profile picture upload
üìÑ Document upload
üìé Resume / attachment upload
üñºÔ∏è Image upload in blogs, posts, or product listings 

Step 2: Just search on Google for web shells. For example, search 'AK47 web shell'. You can also explore others like b374k shell, WSO shell, R57, C99, and China Chopper.
Ex: https://github.com/BlackArch/webshells/blob/master/php/AK-74%20Security%20Team%20Web%20Shell%20Beta%20Version.phpcsrf

Step 3:
Upload the file while Burp Suite Intercept is ON and forward the request.
Check the server response to identify where the file is stored (file path or URL).
Try opening the uploaded file in the browser using the returned path.


step 4: If the application is vulnerable, you will get server command access when you open the link where the uploaded file is stored.




                                                                            
                                                                                          File Upload Bypass Methods
                                                                                          

Attackers may bypass file upload restrictions using the following techniques when server-side validation is strong:

1Ô∏è‚É£ Extension Bypass
1.Using double extensions
Example: file.php.jpg

2.Changing letter case
Example: .PHP, .PhP

3.Adding fake extensions
Example: image.jpg.php


2Ô∏è‚É£ Content-Type (MIME) Bypass
Modifying the Content-Type header
Sending executable files with allowed MIME types (e.g., image/jpeg) etc...




                                                                                                CVSS

CVSS v3.x: 8.8 ‚Äì 9.8
Severity:P1


                                                                                                Impact


If a file upload vulnerability exists, an attacker can:
Upload malicious executable files
Gain remote command execution on the server
Read, modify, or delete server files
Steal credentials and sensitive configuration data
Install backdoors or malware
Achieve full server compromise



                                                                                           Remediation


Enforce strict server-side validation
Allow only safe file types using an allowlist
Validate file content (magic bytes), not just extension or MIME type
Rename uploaded files and remove user-controlled names
Store uploads outside the web root
Disable script execution in upload directories
Apply least privilege permissions
Log and monitor all file upload activities
                                                                                          


