The application leaks password reset tokens through the HTTP Referer header when a user opens a password reset link.
While loading the reset page, the browser makes requests to third-party services (analytics, ads, tracking scripts), and the full reset URL (including the token) is sent in the Referer header to those external domains.
This exposes password reset tokens to third parties and may lead to account takeover.


                                                                                    
                                                                                    Steps to Reproduce



1.Go to a website that supports password reset functionality.

2.Click Forgot Password and enter your email address.

3.Receive a password reset email.

4.Copy the reset password link, for example: https://targetsite.com/reset?token=abc123

5.Open Burp Suite and enable proxy interception or HTTP history.

6.Paste the password reset link into the browser and open it while Burp is running.

7.Observe outgoing requests in Burp to third-party domains, such as: www.google-analytics.com
                                                                     stats.g.doubleclick.net
                                                                      googleads.g.doubleclick.net
                                                                      connect.facebook.net
                                                                       bat.bing.com

8.Inspect the Referer header of those requests.




❌ Actual Behavior:
The full password reset URL, including the reset token, appears in the Referer header.
Third-party domains receive the token.
Token may also appear in GET parameters or cookies accessible to third-party scripts.


✅ Expected Behavior:
Password reset tokens should never be included in: Referer headers
                                                   Third-party requests
                                                   Client-accessible storage
Sensitive tokens should be protected from leakage.




                                                                                        CVSS Score

CVSS v3.1 Base Score: 7.4 – High | P2






                                                                                          Impact
 
An attacker or third party can: Capture password reset tokens via logs or analytics platforms
                                Reset user passwords without authorization
                                Take over user accounts
                                Access sensitive personal or financial data
                               Abuse leaked tokens for large-scale account compromise




                                                                                       Remediation


Do not place reset tokens in URLs,Use POST requests instead

Set strict Referrer-Policy headers: Referrer-Policy: no-referrer [OR] Referrer-Policy: strict-origin

Avoid loading third-party scripts on password reset pages
Use short-lived, single-use tokens
Invalidate tokens immediately after use
Monitor logs for exposed reset tokens
