The application is vulnerable to a Google OAuth 2.0 misconfiguration where access tokens are exposed in the URL fragment and are not properly bound to a specific user session.
An attacker who obtains a valid OAuth access token belonging to another user can reuse that token in their own session, resulting in full account takeover (ATO).


                                                                              
                                                                                   Test Setup


Two test accounts were created: Account A (Victim) – logged in using Microsoft Edge 
                                Account B (Attacker) – logged in using Chrome with Burp Suite


                               
                                                                     
                                                                           Steps to Reproduce


1. Login with Victim Account (Account A)
Log in using Google OAuth.
Observe the redirect URL after authentication.
The URL contains the OAuth access token in the fragment, for example: auth.target.com/redirect#state=XYZ&access_token=victimAccessToken&token_type=Bearer&expires_in=3599&scope=email profile openid


2. Login with Attacker Account (Account B)
Log in using Google OAuth while Burp Suite is running.
Intercept the backend request that includes an OAuth accessToken.


3. Token Replacement
Send the intercepted request to Repeater.
Replace Account B’s accessToken with Account A’s accessToken.



4. Forward the Modified Request
Forward the request to the server.


5. Observe the Result
The server responds with 200 OK.
The attacker’s session is now authenticated as Account A (victim).



                                                                                  
                                                                                  CVSS Score

CVSS v3.1 Base Score: 9.1 – Critical | P1





                                                                                    Impact

An attacker can: Hijack any user account
                View and modify victim profile details
                Change victim passwords
                Access sensitive personal data
                Completely bypass authentication controls
                Perform persistent account takeover



                                                                                Remediation



Do not expose OAuth access tokens in URLs
Use Authorization Code Flow with PKCE
Exchange authorization codes server-side

Bind access tokens to: User ID
                      Session ID

Validate token audience (aud) and subject (sub)
Invalidate tokens on logout or password change
Set short token lifetimes
Apply secure redirect URI validation
