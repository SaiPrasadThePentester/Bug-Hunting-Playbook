The application exposes a backend API endpoint that validates password reset tokens and returns user-specific information (such as the user’s first name) when a valid token is supplied.

By observing the difference in server responses for valid and invalid tokens, an attacker can: Determine whether a password reset token is valid
                                                                                               Extract personal information associated with the token

This leads to information disclosure and can assist attackers in further account takeover or social-engineering attacks.




                                                                                  
                                                                                   Steps to Reproduce



Step 1: Initiate a Password Reset
Go to Target.com.
Click Sign In → Forgot Password.
Enter an email address for a test account.
Receive a password reset email containing a link like: https://www.target.com/reset-password?token=abcd1234


Step 2: Intercept the Token Validation Request
Open Burp Suite and configure the browser to use Burp as a proxy.
Click the password reset link from the email.
Burp intercepts a request similar to: POST /signup/get-first-name-from-password-reset-token


Request body:

{
  "token": "abcd1234"
}





Step 3: Send the Request to Intruder
Right-click the intercepted request → Send to Intruder.
In the Positions tab: Highlight the token value
                     Clear existing markers
                     Add payload markers

{
  "token": "§abcd1234§"
}



Step 4: Add Payloads
Go to the Payloads tab.

Add a list of test values: wrongtoken1
                           wrongtoken2
                            invalidtoken3
                            abcd1234


Step 5: Start the Attack
Click Start Attack.
Observe response codes, response length, and response body.




Step 6: Observe the Behavior

Invalid tokens return a generic error: { "success": false }


Valid token returns a successful response with user data:

{
  "success": true,
  "firstName": "John"
}



➡️ This confirms information disclosure and token validity enumeration.



 
                                                                                      CVSS Score

CVSS v3.1 Base Score: 6.5 – Medium | P2


                                                                                       Impact


An attacker can: Enumerate valid password reset tokens
                Identify users linked to reset tokens
                Harvest personal data (first name, account existence)
                Assist phishing and social-engineering attacks
                Combine with other flaws to achieve account takeover



                                                                                     Remediation



Do not return any user information during token validation
Use generic responses for both valid and invalid tokens
Validate tokens internally without exposing results
Rate-limit token validation endpoints
Invalidate tokens after: One use
                        Short expiration time
Log and monitor abnormal token validation attempts


